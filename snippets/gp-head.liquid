{% assign templateSuffix = template.suffix %}
{% if templateSuffix contains "gem-" and templateSuffix contains "-template" and templateSuffix | split: "-" | size == 3 %}
  {% assign isV6GpTemplate = true %}
{% endif %}
{% if templateSuffix contains "gp-template-" and templateSuffix | split: "-" | size == 3 %}
  {% assign isV7GpTemplate = true %}
{% endif %}
{% assign gpShopMeta = shop.metafields.GEMPAGES %}
{% if request.page_type == 'index' and gpShopMeta and gpShopMeta['index-default'] or request.page_type == 'product' and gpShopMeta and gpShopMeta['product-default'] or request.page_type == 'collection' and gpShopMeta and gpShopMeta['collection-default'] %}
    {% assign isV7GpTemplate = true %}
{% endif %}

{% if isV7GpTemplate %}
  <script src="https://d3kbi0je7pp4lw.cloudfront.net/assets/gp-lazyload.js" async></script>
  <script src="https://d3kbi0je7pp4lw.cloudfront.net/assets/gp-global.js" defer></script>
  {{ 'gp-global.css' | asset_url | stylesheet_tag }}
  {{ 'gp-style.css' | asset_url | stylesheet_tag }}
{% endif %}

{% if isV7GpTemplate %}
  {% if request.page_type == 'page' %}
    {% assign GEMPAGES = page.metafields.GEMPAGES %}
  {% elsif request.page_type == 'product' %}
    {% assign GEMPAGES = product.metafields.GEMPAGES %}
  {% elsif request.page_type == 'index' %}
    {% assign GEMPAGES = shop.metafields.GEMPAGES %}
  {% elsif request.page_type == 'collection' %}
    {% assign GEMPAGES = collection.metafields.GEMPAGES %}
  {% elsif request.page_type == 'article' %}
    {% assign GEMPAGES = article.metafields.GEMPAGES %}
  {% elsif request.page_type == 'blog' %}
    {% assign GEMPAGES = blog.metafields.GEMPAGES %}
  {% endif %}
  {% if GEMPAGES and GEMPAGES['title'] %}
      <meta property="og:title" content="{{ GEMPAGES['title'] }}" />
  {% endif %}
  {% if GEMPAGES and GEMPAGES['description'] %}
      <meta property="og:description" content="{{ GEMPAGES['description'] }}" />
  {% endif %}
  {% if GEMPAGES and GEMPAGES['thumbnail'] %}
      <meta property="og:image" content="{{ GEMPAGES['thumbnail'] }}" />
      <meta property="og:image:alt" content="{{ page_title }}" />
  {% endif %}
{% endif %}

{% if isV6GpTemplate or isV7GpTemplate %}
  {% assign isGpTemplate = true %}
  {% render 'gp-rich-snippets', GEMPAGES: GEMPAGES, isGpTemplate: isGpTemplate %}
  {% render 'gp-header-custom-code', GEMPAGES: GEMPAGES, isGpTemplate: isGpTemplate %}
{% endif %}
  